<!DOCTYPE html>
<html>
<head>
  <base href="$FLUTTER_BASE_HREF">

  <meta charset="UTF-8">
  <meta content="IE=Edge" http-equiv="X-UA-Compatible">
  <meta name="description" content="A new Flutter project.">

  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="pannel">
  <link rel="apple-touch-icon" href="icons/Icon-192.png">

  <link rel="icon" type="image/png" href="favicon.png"/>

  <title>pannel</title>
  <link rel="manifest" href="manifest.json">
  <script>
    function openDevicePopup(url) {
      const width = 414;
      const height = 896;
      const screenWidth = window.screen.width || 1920;
      const screenHeight = window.screen.height || 1080;
      const left = Math.round((screenWidth - width) / 2);
      const top = Math.round((screenHeight - height) / 2);
      const features = 'width=' + width + ',height=' + height + ',left=' + left + ',top=' + top + ',resizable=yes,scrollbars=yes,toolbar=no,menubar=no';
      return window.open(url, '_blank', features);
    }

    // Fix keyboard viewport issue on mobile web
    (function() {
      let viewport = document.querySelector('meta[name=viewport]');
      if (!viewport) {
        viewport = document.createElement('meta');
        viewport.name = 'viewport';
        document.head.appendChild(viewport);
      }
      
      const initialViewport = viewport.content || 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no';
      
      // Reset viewport when keyboard closes
      function handleVisualViewportChange() {
        if (window.visualViewport) {
          const heightDiff = window.visualViewport.height - window.innerHeight;
          if (Math.abs(heightDiff) < 150) {
            // Keyboard is closed, reset viewport
            setTimeout(function() {
              viewport.content = initialViewport;
              document.documentElement.style.height = '100%';
              document.body.style.height = '100%';
            }, 100);
          }
        }
      }
      
      // Listen for viewport changes
      if (window.visualViewport) {
        window.visualViewport.addEventListener('resize', handleVisualViewportChange);
        window.visualViewport.addEventListener('scroll', handleVisualViewportChange);
      }
      
      // Also listen for blur events (when keyboard closes)
      document.addEventListener('blur', function(e) {
        if (e.target && (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA')) {
          setTimeout(function() {
            viewport.content = initialViewport;
            document.documentElement.style.height = '100%';
            document.body.style.height = '100%';
            // Force a resize event
            window.dispatchEvent(new Event('resize'));
          }, 150);
        }
      }, true);
      
      // Handle focus events
      document.addEventListener('focus', function(e) {
        if (e.target && (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA')) {
          // Adjust viewport when keyboard opens
          const viewportHeight = window.visualViewport ? window.visualViewport.height : window.innerHeight;
          const windowHeight = window.innerHeight;
          if (viewportHeight < windowHeight) {
            viewport.content = initialViewport + ', viewport-fit=cover';
          }
        }
      }, true);
    })();
  </script>
</head>
<body>
  <script src="flutter_bootstrap.js" async></script>
</body>
</html>
